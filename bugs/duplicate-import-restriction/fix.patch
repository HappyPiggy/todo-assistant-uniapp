diff --git a/pages/settings/components/ImportShare.vue b/pages/settings/components/ImportShare.vue
index bd66699..af7b1c8 100644
--- a/pages/settings/components/ImportShare.vue
+++ b/pages/settings/components/ImportShare.vue
@@ -186,9 +186,58 @@ const handleImport = async () => {
     
   } catch (error) {
     console.error('å¯¼å…¥å¤±è´¥:', error)
+    
+    // å¦‚æœæ˜¯é‡å¤å¯¼å…¥é”™è¯¯ï¼Œæ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
+    if (error.code === 1005) {
+      await showDuplicateImportDialog(error.data.existingBook)
+    }
   }
 }
 
+const showDuplicateImportDialog = async (existingBook) => {
+  return new Promise((resolve) => {
+    const formatDate = (dateStr) => {
+      const date = new Date(dateStr)
+      return date.toLocaleString('zh-CN', {
+        year: 'numeric',
+        month: '2-digit',
+        day: '2-digit',
+        hour: '2-digit',
+        minute: '2-digit'
+      })
+    }
+    
+    uni.showModal({
+      title: 'é‡å¤å¯¼å…¥æé†’',
+      content: `æ‚¨å·²åœ¨ ${formatDate(existingBook.created_at)} å¯¼å…¥è¿‡é¡¹ç›®å†Œ"${existingBook.title}"ã€‚\n\næ˜¯å¦ä»è¦åˆ›å»ºä¸€ä¸ªæ–°çš„å‰¯æœ¬ï¼Ÿ`,
+      confirmText: 'ä»è¦å¯¼å…¥',
+      cancelText: 'å–æ¶ˆ',
+      success: async (res) => {
+        if (res.confirm) {
+          try {
+            // å…è®¸é‡å¤å¯¼å…¥
+            await importByShareCode(shareCode.value, { allowDuplicate: true })
+            
+            // é€šçŸ¥çˆ¶ç»„ä»¶å¯¼å…¥æˆåŠŸ
+            emit('import-success')
+            
+            // æ¸…ç†çŠ¶æ€
+            clearPreview()
+            shareCode.value = ''
+            
+            resolve(true)
+          } catch (duplicateError) {
+            console.error('é‡å¤å¯¼å…¥å¤±è´¥:', duplicateError)
+            resolve(false)
+          }
+        } else {
+          resolve(false)
+        }
+      }
+    })
+  })
+}
+
 const clearPreview = () => {
   previewData.value = null
 }
diff --git a/pages/settings/composables/useShareData.js b/pages/settings/composables/useShareData.js
index fe079b1..292b449 100644
--- a/pages/settings/composables/useShareData.js
+++ b/pages/settings/composables/useShareData.js
@@ -100,15 +100,18 @@ export function useShareData() {
   /**
    * é€šè¿‡åˆ†äº«ç å¯¼å…¥é¡¹ç›®å†Œ
    * @param {string} shareCode - åˆ†äº«ç 
+   * @param {Object} options - å¯¼å…¥é€‰é¡¹
+   * @param {boolean} options.allowDuplicate - æ˜¯å¦å…è®¸é‡å¤å¯¼å…¥
    * @returns {Promise<Object>} å¯¼å…¥ç»“æœ
    */
-  const importByShareCode = async (shareCode) => {
+  const importByShareCode = async (shareCode, options = {}) => {
+    const { allowDuplicate = false } = options
     importLoading.value = true
     error.value = null
     
     try {
       const todoBookCo = uniCloud.importObject('todobook-co')
-      const result = await todoBookCo.importByCode(shareCode)
+      const result = await todoBookCo.importByCode(shareCode, allowDuplicate)
       
       if (result.code === 0) {
         // å¯¼å…¥æˆåŠŸåé‡æ–°åŠ è½½é¡¹ç›®å†Œåˆ—è¡¨å¹¶è§¦å‘æ›´æ–°äº‹ä»¶
@@ -130,16 +133,27 @@ export function useShareData() {
           icon: 'success'
         })
         return result.data
+      } else if (result.code === 1005) {
+        // é‡å¤å¯¼å…¥çš„ç‰¹æ®Šå¤„ç†
+        const duplicateError = new Error(result.message)
+        duplicateError.code = 1005
+        duplicateError.data = result.data
+        throw duplicateError
       } else {
         throw new Error(result.message)
       }
     } catch (err) {
       console.error('å¯¼å…¥åˆ†äº«å¤±è´¥:', err)
       error.value = err.message
-      uni.showToast({
-        title: err.message,
-        icon: 'none'
-      })
+      
+      // å¯¹äºé‡å¤å¯¼å…¥é”™è¯¯ï¼Œä¸æ˜¾ç¤ºtoastï¼Œç”±è°ƒç”¨æ–¹å¤„ç†
+      if (err.code !== 1005) {
+        uni.showToast({
+          title: err.message,
+          icon: 'none'
+        })
+      }
+      
       throw err
     } finally {
       importLoading.value = false
diff --git a/uniCloud-alipay/cloudfunctions/todobook-co/index.obj.js b/uniCloud-alipay/cloudfunctions/todobook-co/index.obj.js
index fe4dc47..8fd69d6 100644
--- a/uniCloud-alipay/cloudfunctions/todobook-co/index.obj.js
+++ b/uniCloud-alipay/cloudfunctions/todobook-co/index.obj.js
@@ -132,14 +132,14 @@ module.exports = {
   /**
    * é€šè¿‡åˆ†äº«ç å¯¼å…¥é¡¹ç›®å†Œ
    */
-  async importByCode(shareCode) {
-    return await importByCode.call(this, { shareCode })
+  async importByCode(shareCode, allowDuplicate = false) {
+    return await importByCode.call(this, shareCode, allowDuplicate)
   },
 
   /**
    * è·å–åˆ†äº«é¢„è§ˆ
    */
   async getSharePreview(shareCode) {
-    return await getSharePreview.call(this, { shareCode })
+    return await getSharePreview.call(this, shareCode)
   }
 }
\ No newline at end of file
diff --git a/uniCloud-alipay/cloudfunctions/todobook-co/module/share/get-share-preview.js b/uniCloud-alipay/cloudfunctions/todobook-co/module/share/get-share-preview.js
index 9ea6597..9444862 100644
--- a/uniCloud-alipay/cloudfunctions/todobook-co/module/share/get-share-preview.js
+++ b/uniCloud-alipay/cloudfunctions/todobook-co/module/share/get-share-preview.js
@@ -2,7 +2,7 @@
  * è·å–åˆ†äº«é¢„è§ˆä¿¡æ¯
  */
 
-module.exports = async function getSharePreview({ shareCode }) {
+module.exports = async function getSharePreview(shareCode) {
   try {
     const db = this.db
     
diff --git a/uniCloud-alipay/cloudfunctions/todobook-co/module/share/import-by-code.js b/uniCloud-alipay/cloudfunctions/todobook-co/module/share/import-by-code.js
index 9ea5482..b871f5d 100644
--- a/uniCloud-alipay/cloudfunctions/todobook-co/module/share/import-by-code.js
+++ b/uniCloud-alipay/cloudfunctions/todobook-co/module/share/import-by-code.js
@@ -4,7 +4,8 @@
 
 const { cloneTodoBook } = require('./utils/todobook-cloner')
 
-module.exports = async function importByCode({ shareCode }) {
+module.exports = async function importByCode(shareCode, allowDuplicate = false) {
+  
   try {
     const db = this.db
     const userId = this.uid
@@ -57,12 +58,37 @@ module.exports = async function importByCode({ shareCode }) {
       }
     }
     
-    // 5. å…‹éš†åˆ†äº«æ¨¡æ¿ä¸ºæ–°é¡¹ç›®å†Œ
+    // 5. æ£€æŸ¥æ˜¯å¦å·²ç»å¯¼å…¥è¿‡è¯¥åˆ†äº«ï¼ˆå¦‚æœä¸å…è®¸é‡å¤ï¼‰
+    if (!allowDuplicate) {
+      const existingImports = await bookCollection.where({
+        creator_id: userId,
+        imported_from_share_id: shareRecord._id
+      }).get()
+      
+      if (existingImports.data.length > 0) {
+        const existingBook = existingImports.data[0]
+        return {
+          code: 1005,
+          message: 'æ‚¨å·²ç»å¯¼å…¥è¿‡è¿™ä¸ªåˆ†äº«é¡¹ç›®å†Œ',
+          data: {
+            existingBook: {
+              id: existingBook._id,
+              title: existingBook.title,
+              created_at: existingBook.created_at
+            },
+            allowDuplicate: true
+          }
+        }
+      }
+    }
+    
+    // 6. å…‹éš†åˆ†äº«æ¨¡æ¿ä¸ºæ–°é¡¹ç›®å†Œ
+    const titleSuffix = allowDuplicate ? 'ï¼ˆæ¥è‡ªåˆ†äº«ï¼‰' : 'ï¼ˆæ¥è‡ªåˆ†äº«ï¼‰'
     const newBookId = await cloneTodoBook(db, sharedTodoBookId, {
       includeComments: shareRecord.include_comments,
       isTemplate: false,
       newCreatorId: userId,
-      titleSuffix: 'ï¼ˆæ¥è‡ªåˆ†äº«ï¼‰'
+      titleSuffix: titleSuffix
     })
     
     // éªŒè¯å…‹éš†ç»“æœçš„æ•°æ®å®Œæ•´æ€§
@@ -98,7 +124,12 @@ module.exports = async function importByCode({ shareCode }) {
       console.error('ğŸ” [å¯¼å…¥éªŒè¯] éªŒè¯å¯¼å…¥ç»“æœæ—¶å‡ºé”™:', verifyError)
     }
     
-    // 6. æ›´æ–°åˆ†äº«ç»Ÿè®¡
+    // 7. ä¸ºå¯¼å…¥çš„é¡¹ç›®å†Œæ·»åŠ æ¥æºæ ‡è®°
+    await bookCollection.doc(newBookId).update({
+      imported_from_share_id: shareRecord._id
+    })
+    
+    // 8. æ›´æ–°åˆ†äº«ç»Ÿè®¡
     await shareCollection.doc(shareRecord._id).update({
       share_count: db.command.inc(1),
       last_import_at: new Date()
diff --git a/uniCloud-alipay/database/todobooks.schema.json b/uniCloud-alipay/database/todobooks.schema.json
index dc37366..cb54980 100644
--- a/uniCloud-alipay/database/todobooks.schema.json
+++ b/uniCloud-alipay/database/todobooks.schema.json
@@ -117,6 +117,10 @@
 		"template_created_at": {
 			"bsonType": "timestamp",
 			"description": "æ¨¡æ¿åˆ›å»ºæ—¶é—´ï¼ˆä»…åˆ†äº«æ¨¡æ¿ä½¿ç”¨ï¼‰"
+		},
+		"imported_from_share_id": {
+			"bsonType": "string",
+			"description": "å¯¼å…¥æ¥æºåˆ†äº«è®°å½•IDï¼ˆç”¨äºé˜²æ­¢é‡å¤å¯¼å…¥ï¼‰"
 		}
 	}
 }