diff --git a/uniCloud-alipay/cloudfunctions/todobook-co/module/share/utils/todobook-cloner.js b/uniCloud-alipay/cloudfunctions/todobook-co/module/share/utils/todobook-cloner.js
index abc123..def456 100644
--- a/uniCloud-alipay/cloudfunctions/todobook-co/module/share/utils/todobook-cloner.js
+++ b/uniCloud-alipay/cloudfunctions/todobook-co/module/share/utils/todobook-cloner.js
@@ -106,6 +106,32 @@ async function cloneTodoBook(db, originalBookId, options = {}) {
       return userAnonymizeMapping.get(originalUserId)
     }
     
+    // è¾…åŠ©å‡½æ•°ï¼šæ›´æ–°è¯„è®ºIDä»¥åŒ¹é…æ–°ä»»åŠ¡ID
+    const updateCommentIds = (comments, newTaskId) => {
+      if (!comments || !Array.isArray(comments)) return []
+      
+      const commentIdMapping = new Map() // è®°å½•æ—§è¯„è®ºIDåˆ°æ–°è¯„è®ºIDçš„æ˜ å°„
+      
+      // ç¬¬ä¸€è½®ï¼šç”Ÿæˆæ–°çš„è¯„è®ºIDå¹¶å»ºç«‹æ˜ å°„å…³ç³»
+      const updatedComments = comments.map(comment => {
+        const updatedComment = { ...comment }
+        
+        // ä»åŸè¯„è®ºIDä¸­æå–æ—¶é—´æˆ³å’Œéšæœºå­—ç¬¦ä¸²éƒ¨åˆ†
+        const commentParts = comment._id.split('_')
+        if (commentParts.length >= 3) {
+          const timestamp = commentParts[1]
+          const random = commentParts[2]
+          const newCommentId = `${newTaskId}_${timestamp}_${random}`
+          
+          // è®°å½•æ˜ å°„å…³ç³»
+          commentIdMapping.set(comment._id, newCommentId)
+          updatedComment._id = newCommentId
+          
+          console.log(`ğŸ” [è¯„è®ºIDæ›´æ–°] ${comment._id} -> ${newCommentId}`)
+        }
+        
+        return updatedComment
+      })
+      
+      // ç¬¬äºŒè½®ï¼šæ›´æ–°reply_toå­—æ®µä¸­çš„è¯„è®ºIDå¼•ç”¨
+      return updatedComments.map(comment => {
+        if (comment.reply_to && commentIdMapping.has(comment.reply_to)) {
+          comment.reply_to = commentIdMapping.get(comment.reply_to)
+          console.log(`ğŸ” [å›å¤å…³ç³»æ›´æ–°] reply_to: ${comment.reply_to}`)
+        }
+        return comment
+      })
+    }
+    
     // è¾…åŠ©å‡½æ•°ï¼šåŒ¿ååŒ–è¯„è®ºæ•°ç»„
     const anonymizeComments = (comments) => {
       if (!comments || !Array.isArray(comments)) return []
@@ -175,9 +201,20 @@ async function cloneTodoBook(db, originalBookId, options = {}) {
       }
       
       const newTaskResult = await taskCollection.add(newTaskData)
-      taskIdMapping.set(originalTask._id, newTaskResult.id)
+      const newTaskId = newTaskResult.id
+      taskIdMapping.set(originalTask._id, newTaskId)
       taskCount++
       
-      // è°ƒè¯•ä¿¡æ¯ï¼šè®°å½•ä»»åŠ¡å…‹éš†
-      console.log(`ğŸ” [å…‹éš†è°ƒè¯•] å…‹éš†ä»»åŠ¡: ${originalTask._id} -> ${newTaskResult.id} (${originalTask.title})`)
+      // è°ƒè¯•ä¿¡æ¯ï¼šè®°å½•ä»»åŠ¡å…‹éš†
+      console.log(`ğŸ” [å…‹éš†è°ƒè¯•] å…‹éš†ä»»åŠ¡: ${originalTask._id} -> ${newTaskId} (${originalTask.title})`)
+      
+      // å¦‚æœåŒ…å«è¯„è®ºï¼Œéœ€è¦æ›´æ–°è¯„è®ºIDä»¥åŒ¹é…æ–°ä»»åŠ¡ID
+      if (includeComments && newTaskData.comments && newTaskData.comments.length > 0) {
+        console.log(`ğŸ” [è¯„è®ºIDä¿®å¤] å¼€å§‹æ›´æ–°ä»»åŠ¡ ${newTaskId} çš„è¯„è®ºID`)
+        const updatedComments = updateCommentIds(newTaskData.comments, newTaskId)
+        
+        // æ›´æ–°æ•°æ®åº“ä¸­çš„è¯„è®º
+        await taskCollection.doc(newTaskId).update({
+          comments: updatedComments
+        })
+        
+        console.log(`ğŸ” [è¯„è®ºIDä¿®å¤] ä»»åŠ¡ ${newTaskId} çš„è¯„è®ºIDæ›´æ–°å®Œæˆï¼Œå…±æ›´æ–° ${updatedComments.length} æ¡è¯„è®º`)
+      }
     }
     
     // 4. æ›´æ–°ä»»åŠ¡çš„parent_idå…³ç³»

--- /dev/null
+++ b/uniCloud-alipay/cloudfunctions/todobook-co/scripts/fix-imported-comment-ids.js
@@ -0,0 +1,180 @@
+/**
+ * ä¿®å¤å·²å¯¼å…¥TodoBookä¸­çš„è¯„è®ºIDé—®é¢˜
+ * è¿™ä¸ªè„šæœ¬ç”¨äºä¿®å¤å·²ç»å¯¼å…¥ä½†è¯„è®ºIDæ²¡æœ‰æ­£ç¡®æ›´æ–°çš„TodoBook
+ */
+
+/**
+ * ä¿®å¤å·²å¯¼å…¥TodoBookçš„è¯„è®ºID
+ * @param {object} db - æ•°æ®åº“å¯¹è±¡
+ * @returns {Promise<object>} ä¿®å¤ç»“æœç»Ÿè®¡
+ */
+async function fixImportedCommentIds(db) {
+  // ... [è„šæœ¬å†…å®¹] ...
+}
+
+/**
+ * éªŒè¯ä¿®å¤ç»“æœ
+ * @param {object} db - æ•°æ®åº“å¯¹è±¡
+ * @returns {Promise<object>} éªŒè¯ç»“æœ
+ */
+async function verifyFixResults(db) {
+  // ... [éªŒè¯é€»è¾‘] ...
+}
+
+module.exports = {
+  fixImportedCommentIds,
+  verifyFixResults
+}

--- /dev/null
+++ b/uniCloud-alipay/cloudfunctions/todobook-co/scripts/test-comment-id-fix.js
@@ -0,0 +1,120 @@
+/**
+ * æµ‹è¯•è¯„è®ºIDä¿®å¤é€»è¾‘
+ * è¿™ä¸ªè„šæœ¬ç”¨äºæµ‹è¯•updateCommentIdså‡½æ•°çš„æ­£ç¡®æ€§
+ */
+
+/**
+ * æµ‹è¯•updateCommentIdså‡½æ•°
+ */
+function testUpdateCommentIds() {
+  // ... [æµ‹è¯•é€»è¾‘] ...
+}
+
+module.exports = {
+  testUpdateCommentIds
+}