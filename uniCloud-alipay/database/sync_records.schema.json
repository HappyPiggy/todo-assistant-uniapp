{
  "bsonType": "object",
  "required": ["user_id", "sync_type", "created_at"],
  "properties": {
    "_id": {
      "description": "ID，系统自动生成"
    },
    "user_id": {
      "bsonType": "string",
      "description": "用户ID"
    },
    "device_id": {
      "bsonType": "string",
      "description": "设备ID"
    },
    "sync_type": {
      "bsonType": "string",
      "enum": ["manual", "auto", "force"],
      "description": "同步类型：manual手动，auto自动，force强制"
    },
    "sync_direction": {
      "bsonType": "string",
      "enum": ["upload", "download", "bidirectional"],
      "default": "bidirectional",
      "description": "同步方向"
    },
    "status": {
      "bsonType": "string",
      "enum": ["pending", "in_progress", "completed", "failed"],
      "default": "pending",
      "description": "同步状态"
    },
    "created_at": {
      "bsonType": "timestamp",
      "description": "同步开始时间"
    },
    "completed_at": {
      "bsonType": "timestamp",
      "description": "同步完成时间"
    },
    "data_summary": {
      "bsonType": "object",
      "properties": {
        "todobooks_synced": {
          "bsonType": "int",
          "default": 0,
          "description": "同步的项目册数量"
        },
        "todoitems_synced": {
          "bsonType": "int",
          "default": 0,
          "description": "同步的任务数量"
        },
        "conflicts_resolved": {
          "bsonType": "int",
          "default": 0,
          "description": "解决的冲突数量"
        }
      },
      "description": "同步数据统计"
    },
    "error_message": {
      "bsonType": "string",
      "description": "错误信息"
    },
    "error_details": {
      "bsonType": "object",
      "description": "详细错误信息"
    },
    "local_version": {
      "bsonType": "string",
      "description": "本地数据版本"
    },
    "remote_version": {
      "bsonType": "string",
      "description": "远程数据版本"
    },
    "sync_duration": {
      "bsonType": "int",
      "description": "同步耗时（毫秒）"
    }
  }
}