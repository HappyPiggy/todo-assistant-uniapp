# 归档管理功能实施任务清单

## 任务列表

### 1. 用户中心页面更新

- [ ] 1.1 修改ucenter.vue中的"数据统计"菜单项
  - 将`toStatistics`方法替换为`toArchiveManagement`方法
  - 更新菜单项文本从"数据统计"改为"归档管理"
  - 添加归档管理页面的导航跳转逻辑
  - _Requirements: 1.1, 1.2, 1.3_

### 2. 创建归档管理页面结构

- [ ] 2.1 创建归档管理页面目录结构
  - 创建`/pages/archive-management/`目录
  - 创建`index.vue`主页面文件
  - 创建`index.scss`样式文件
  - 创建`composables/useArchiveData.js`组合式函数
  - _Requirements: 2.1, 2.2_

- [ ] 2.2 配置路由和页面基础结构
  - 在`pages.json`中添加归档管理页面配置
  - 设置页面标题、导航栏样式和下拉刷新配置
  - 实现页面基础模板结构
  - _Requirements: 2.1, 2.5_

### 3. 实现归档数据管理功能

- [ ] 3.1 扩展useBookData组合式函数
  - 在`useBookData.js`中添加`loadArchivedTodoBooks`方法
  - 实现归档项目册数据加载逻辑
  - 添加错误处理和加载状态管理
  - _Requirements: 3.1, 8.1, 8.4_

- [ ] 3.2 创建useArchiveData组合式函数
  - 实现`loadArchivedBooks`方法调用云函数获取归档数据（包含成员信息）
  - 实现`unarchiveTodoBook`方法（预留功能）
  - 添加数据缓存和状态管理逻辑
  - _Requirements: 3.1, 8.2_

- [ ] 3.3 实现归档统计数据计算
  - 在`useArchiveData`中添加`archiveStats`计算属性
  - 实现项目册总数、任务总数、完成任务数的统计
  - 实现整体完成率计算逻辑
  - 实现去重成员数统计（基于用户ID去重）
  - _Requirements: 2.2, 2.3, 2.4, 2.5, 2.6_

### 4. 实现归档管理页面UI

- [ ] 4.1 实现归档统计卡片组件
  - 创建渐变背景的统计卡片样式
  - 实现4个统计指标的网格布局（项目册数、总任务、已完成、完成率）
  - 添加成员数统计的底部汇总信息
  - 实现无数据时的零值显示逻辑
  - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7_

- [ ] 4.2 实现归档项目册列表展示
  - 创建紧凑型项目册卡片组件
  - 实现项目册基本信息显示（标题、归档时间、统计数据）
  - 添加项目册点击跳转到详情页功能
  - _Requirements: 3.2, 3.3, 4.1, 4.3_

- [ ] 4.3 实现页面状态管理
  - 添加加载状态指示器
  - 实现空状态提示界面（包含统计卡片的空状态）
  - 添加错误状态处理和重试功能
  - _Requirements: 3.4, 3.5, 8.4_

- [ ] 4.4 实现下拉刷新功能
  - 配置页面下拉刷新
  - 实现数据重新加载逻辑（包含统计数据刷新）
  - 添加刷新状态提示
  - _Requirements: 8.3_

### 5. 实现归档状态检测和编辑限制

- [ ] 5.1 扩展项目册详情页面归档检测
  - 在`detail.vue`中添加归档状态检测逻辑
  - 实现`isArchived`计算属性
  - 添加编辑权限控制逻辑
  - _Requirements: 5.1, 5.2, 5.3, 5.4_

- [ ] 5.2 实现任务编辑限制
  - 在任务组件中添加归档状态传递
  - 禁用归档项目册中的任务新增、编辑、删除功能
  - 添加相应的UI状态指示
  - _Requirements: 5.1, 5.2_

- [ ] 5.3 实现评论功能限制
  - 在评论组件中添加归档状态检测
  - 隐藏或禁用归档项目册的评论输入框
  - 添加归档状态提示信息
  - _Requirements: 5.3_

### 6. 修改操作菜单限制

- [ ] 6.1 更新TodoBookActionSheet组件
  - 添加归档状态检测逻辑
  - 实现归档项目册菜单项筛选（只显示分享和删除）
  - 修改操作菜单的显示逻辑
  - _Requirements: 6.1, 6.2, 6.3, 6.4_

- [ ] 6.2 隐藏归档项目册任务菜单
  - 在任务列表组件中添加归档状态检测
  - 隐藏归档项目册中任务的操作菜单按钮
  - 对子任务也应用相同的限制逻辑
  - _Requirements: 7.1, 7.2, 7.3_

### 7. 实现页面样式和交互

- [ ] 7.1 创建归档统计卡片样式
  - 实现渐变背景的统计卡片设计
  - 添加统计数据的网格布局样式
  - 实现响应式布局适配
  - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6_

- [ ] 7.2 创建归档项目册列表样式
  - 实现紧凑型项目册卡片样式设计
  - 添加归档时间显示样式
  - 实现项目册统计信息的布局
  - _Requirements: 3.2, 3.3_

- [ ] 7.3 添加归档状态视觉标识
  - 在项目册详情页添加归档状态标识
  - 为归档项目册添加特殊的视觉样式
  - 实现编辑限制的用户界面提示
  - _Requirements: 5.4_

- [ ] 7.4 优化交互体验
  - 添加页面切换动画效果
  - 实现触摸反馈和加载动画
  - 优化错误提示和用户引导
  - _Requirements: 8.1, 8.2_

### 8. 测试和调试

- [ ] 8.1 功能测试
  - 测试用户中心到归档管理页面的导航
  - 测试归档统计数据的正确计算和显示
  - 测试归档项目册列表的加载和显示
  - 测试归档项目册详情页面的访问和限制
  - _Requirements: 所有需求_

- [ ] 8.2 边界条件测试
  - 测试无归档项目册时的统计卡片和列表空状态显示
  - 测试网络错误时的错误处理
  - 测试权限不足时的处理逻辑
  - 测试统计数据计算的边界情况（如除零）
  - _Requirements: 2.7, 3.4, 8.4_

- [ ] 8.3 交互测试
  - 测试归档项目册的编辑限制是否生效
  - 测试操作菜单的显示限制
  - 测试评论功能的禁用状态
  - 测试下拉刷新时统计数据的同步更新
  - _Requirements: 5.1, 5.2, 5.3, 6.1, 6.2, 6.3, 6.4, 7.1, 7.2, 7.3, 8.3_

### 9. 性能优化和收尾

- [ ] 9.1 性能优化
  - 优化归档统计数据的计算性能
  - 优化归档项目册列表的渲染性能
  - 实现数据加载的防抖处理
  - 添加页面卸载时的资源清理
  - _Requirements: 8.1, 8.2, 8.3_

- [ ] 9.2 代码清理和文档
  - 清理调试代码和无用注释
  - 确保代码符合项目编码规范
  - 验证所有功能按设计要求实现（包含统计功能）
  - _Requirements: 所有需求_