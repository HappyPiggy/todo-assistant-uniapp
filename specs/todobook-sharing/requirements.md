# 需求文档 - 项目册分享功能

## 介绍

为大薯的记录册应用添加项目册分享功能，允许用户将自己的项目册制作成快照模板分享给其他用户，其他用户可以通过分享码导入（克隆）项目册到自己的账户中。

## 需求

### 需求 1 - 项目册分享功能

**用户故事：** 作为用户，我希望能够分享我的项目册给其他人，让他们可以复制我的项目册结构和任务安排到他们自己的账户中。

#### 验收标准

1. When 用户在项目册详情页点击菜单时，系统应当显示"分享"选项，选项前显示对应图标。
2. When 用户选择"分享"选项时，系统应当显示分享设置页面，包含"是否包含评论"的选择项（默认不包含）。
3. When 用户确认分享时，系统应当创建项目册快照，包含所有任务和子任务（状态重置为未完成），根据用户选择决定是否包含评论。
4. When 项目册快照创建成功时，系统应当生成6位字母数字组合的分享码，并显示给用户，提供快捷复制按钮。
5. When 用户已有2个分享模板时，系统应当提示用户需要删除现有分享才能创建新的分享，前后端都需要进行校验处理。
6. When 用户对原项目册进行修改或删除时，已分享的云端模板应当不受影响。

### 需求 2 - 分享管理页面

**用户故事：** 作为用户，我希望能够管理我已经分享的项目册，查看分享码，并可以删除不需要的分享。

#### 验收标准

1. When 用户进入设置页面时，系统应当显示"分享管理"选项。
2. When 用户点击"分享管理"时，系统应当显示分享管理页面。
3. While 在分享管理页面，when 页面加载时，系统应当显示当前用户所有已分享的项目册列表。
4. While 在分享管理页面，when 显示分享项目册时，系统应当显示项目册名称、图标、描述和对应的分享码。提供一键复制分享码的按钮。
5. When 用户点击删除分享码时，系统应当弹出确认对话框。
6. When 用户确认删除分享码时，系统应当删除云端分享模板，使分享码失效。
7. When 分享码被删除后，已经通过该码导入的用户应当可以继续正常使用已导入的项目册。

### 需求 3 - 通过分享码导入项目册

**用户故事：** 作为用户，我希望能够通过其他人提供的分享码导入项目册模板到我的账户中。

#### 验收标准

1. While 在分享管理页面，when 用户输入6位分享码时，系统应当验证分享码的有效性。
2. When 分享码有效时，系统应当显示项目册预览信息（名称、描述、任务数量等）。
3. When 用户确认导入时，系统应当将分享模板克隆为新的项目册。
4. When 导入成功时，新项目册应当添加"（来自分享）"后缀以区分来源。
5. When 导入成功时，用户应当成为新项目册的创建者，拥有完整的编辑权限。
6. When 导入成功时，新项目册应当出现在用户的首页项目册列表中。
7. When 分享码无效时，系统应当提示"分享码不存在或已失效"。
8. When 用户输入非6位字母数字组合时，系统应当提示"请输入正确格式的分享码"。

### 需求 4 - 分享限制和数据隔离

**用户故事：** 作为系统管理员，我希望控制分享功能的使用限制，确保数据安全和系统稳定。

#### 验收标准

1. When 用户尝试创建第3个分享时，系统应当提示"最多只能同时分享2个项目册，请先删除现有分享"。
2. When 项目册被导入后，系统应当确保导入的项目册与原分享模板完全隔离，互不影响。
3. When 原项目册被修改或删除时，云端分享模板应当保持不变。
4. When 分享模板被删除时，已导入的项目册应当不受影响，继续正常使用。
5. While 云端分享模板存在时，系统应当永久保存，不设置过期时间。

## 设计要求

### UI设计风格
- 保持与现有应用一致的设计风格
- 使用uni-ui组件库的标准组件
- 分享码显示使用等宽字体，方便识别
- 分享管理页面采用卡片式布局展示已分享的项目册

### 交互设计
- 分享操作提供明确的成功反馈
- 导入操作提供预览确认步骤
- 删除操作提供二次确认机制
- 所有异步操作提供加载状态提示